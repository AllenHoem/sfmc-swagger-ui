openapi: 3.0.0
servers: []
info:
  description: ''
  version: 215.180803
  title: Transactional Messaging APIs (Pre-Release)
paths:
  '/transactionalmessages/v1/{channel}/definitions/':
    parameters:
      - in: path
        name: channel
        required: true
        schema:
          type: string
          enum:
            - email
            - sms
    post:
      tags:
        - ' definitions'
      summary: create a send defintion with autogenerated key
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/S_definition_response_body'
                  - $ref: '#/components/schemas/S_definition_request_body'

      requestBody:
        $ref: '#/components/requestBodies/RQ_definition'    
    get:
      tags:
        - ' definitions'
      summary: gets a list of defintions
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/S_definition_response_body'
                  - $ref: '#/components/schemas/S_definition_request_body'

  '/transactionalmessages/v1/{channel}/definitions/{definitionKey}':
    parameters:
      - in: path
        name: definitionKey
        description: your  send defintion
        required: true
        schema:
          type: string
      - in: path
        name: channel
        required: true
        schema:
          type: string
          enum:
            - email
            - sms
    get:
      tags:
        - ' definitions'
      summary: gets configuration of a defintion
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/S_definition_response_body'
                  - $ref: '#/components/schemas/S_definition_request_body'
    patch:
      tags:
        - ' definitions'
      summary: modify a defintion
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/S_definition_response_body'
                  - $ref: '#/components/schemas/S_definition_request_body'
    delete:
      tags:
        - ' definitions'
      summary: delete a defintion
      responses:
        '200':
          description: OK
    post:
       tags:
        - ' definitions'
      summary: create a send definition
      description: ''
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/S_definition_response_body'
                  - $ref: '#/components/schemas/S_definition_request_body'
                 # - $ref: '#/components/schemas/messageSendResponse'
      requestBody:
        $ref: '#/components/requestBodies/RQ_definition'

components:
  requestBodies:
    RQ_definition:
      content:
        application/json:
          schema:
            allOf:
              - $ref: '#/components/schemas/S_definition_request_body' #must nest attribute
              #S_Message
        
  schemas:
    S_definition_response_body:
      properties:
        requestId:
            type: string
            example: UUID  
        createdDate:
            type: dateTime
            example:  "2018-07-18T19:52:00"
          modifiedDate:
            type: string
            example:  "2018-07-18T19:52:00"
    S_definition_request_body:
      properties:
        definitionKey:
          type: string
        status:
          type: string
        classification:
          type: string
          example: "Default Transactional"
          description: "(R216) The external_key for a transactional classifications. Commericials sends are not supported. "
        name:
          type: string
          example: " "
        description:
          type: string
          example: " "
        description:
          type: string
          example: " "
        content:
           $ref: '#/components/schemas/S_Content'
        subscriptions:
           $ref: '#/components/schemas/S_Subscriptions'
        options:
           $ref: '#/components/schemas/S_Options'
    S_Content:
      properties:
        contentKey:
          type: string
          example: UUID
          description: The customer_key provided in Content Builder for a given asset
    S_Options:
      properties:  
        trackLinks:
            type: boolean
            example: true
            description: (R216) The customer_key provided in Content Builder for a given asset    
    S_Subscriptions:
      properties: 
        list:
            type: string
            example: my_list_customer_key
            description: The customer_key provided in you list properties.
        dataExtention:
            type: string
            example: my_data_extension_external_key
            description: The external_key provided from your DE properties.
        autoAddSubscriber:
            type: boolean
            example: true
            description: (R216) Add subscriber address, subscriber key and personalization attributes to the list when the attributes match. Updates are keyed off of the subscriberKey
        updateSubscriber:
            type: string
            example: true
            description: (R216) Updates subscriber address and personalization attributes to the list when the attributes match for a given subscriberKey


#---------------------------------#
#--   COMPONENT.RESPONSES       --#
#---------------------------------#
    RS_request:
      type: object
      properties:
        requestId:
          type: string
          format: UUID v4
          example: ba9633fa-5c8d-4c42-8efa-a16412ac0c53
        errorCode:
          type: integer
          example: 7005
        errorMessage:
          type: string
          example: Ensure you include all required fields in the body of the request
    RS_message:
      type: object
      properties:
        responses:
          type: array
          items:
            type: object
            properties:
              messageKey:
                type: string
                example: 9691010a-1e59-48a0-b0d8-67d9a86dc470
              errorCode:
                type: integer
              errorMessage:
                type: string
